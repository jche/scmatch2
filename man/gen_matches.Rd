% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/matching.R
\name{gen_matches}
\alias{gen_matches}
\title{Match treated units to control units}
\usage{
gen_matches(
  data,
  covs = get_x_vars(data),
  treatment = "Z",
  scaling = 1,
  metric = c("maximum", "euclidean", "manhattan"),
  caliper = 1,
  rad_method = c("adaptive", "fixed", "1nn", "knn", "knn-capped"),
  id_name = NULL,
  k = 1,
  dm = NULL,
  ...
)
}
\arguments{
\item{data}{Data frame with covariates and treatment indicator.}

\item{covs}{Covariate names.}

\item{treatment}{Treatment indicator column (0/1).}

\item{scaling}{Length-P vector of scaling constants (or a
single-row data frame). Each covariate is scaled by its value.
Often 1/sd. Defaults to 1. If covs not supplied, the argument
name is used to identify covariates.}

\item{metric}{Distance metric: "maximum", "euclidean", or
"manhattan".}

\item{caliper}{Caliper size. Sets the max allowed distance between
matches. Often 1. Scaling usually handles covariate importance.}

\item{rad_method}{How to set the radius for each treated unit:
\itemize{
\item "adaptive": max(caliper, distance to nearest control)
\item "fixed": use caliper; drop treated with no controls inside it
\item "1nn": distance to nearest neighbor
\item "adaptive-5nn": adaptive with cap at 5th NN
\item "knn": distance to the k-th nearest neighbor
}}

\item{id_name}{Column name for unit IDs. If missing, an \code{id}
column using row numbers is created.}

\item{k}{For adaptive, number of units needed for minimum radius.
For "knn", number of neighbors. Defaults to 1.}

\item{dm}{Optional treated-control distance matrix. Calipers are
applied but distances are not recomputed.}

\item{...}{Extra arguments}

\item{est_method}{How to weight control units:
\itemize{
\item "scm": synthetic control weights
\item "scm_extrap": SCM with extrapolation
\item "average": simple average
}}
}
\value{
A list of results.  matches: list of small datasets of
matched control units for each treated unit.  adacalipers: vector
of adaptive calipers for each treated unit.  dm_trimmed: distance
matrix with control units farther than caliper censored with NA
dm_uncapped: distance matrix without any control units censored.
}
\description{
Generate matches for each treatment over controls using specified
covariate names, distance metric specified by the scaling parameter
and the method of metric. Finally, there is a selection of the
units
}
\details{
Note: we allow controls to be repeatedly used (we match with
replacement).

Generally use the \code{get_cal_matches()} function instead, which
wraps this.
}
\examples{
data <- CSM:::gen_one_toy()
mtch <- gen_matches(data, covs = c("X1", "X2"), treatment = "Z")
names( mtch )
}
